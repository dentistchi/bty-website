# Arena 멤버십 · 레벨 · 아바타 제안서

멤버십 가입(직군·입사일·리더시작일) → **승인 플로우**, **ARENA LEVELS 카드**, **레벨 표현 아이디어**, **아바타 아이디어**를 한 문서에 정리합니다.

---

## 1. 멤버십 가입 + 승인 플로우

### 1.1 요구사항 정리

- **가입 시 입력**: 직군(job_function), 입사일(joined_at), 리더시작일(leader_started_at, 리더 직군인 경우).
- **승인**: 입사일·리더시작일은 **승인 필요** → Admin(당신)이 승인해야 해당 “리(트랙/레벨)”에 들어갈 수 있음.
- **승인 수단**: 가입/수정 시 **ddshanbit@gmail.com**으로 이메일 발송 → Admin이 앱에서 승인 → 해당 유저가 Arena 트랙/레벨 접근.
- **아랫단계 오픈**: 예) L1 승인 시 **S1, S2, S3도 모두 플레이 가능**. 리더가 되어도 기초 스태프 시나리오를 연습할 수 있게.

### 1.2 데이터/API 제안

| 항목 | 제안 |
|------|------|
| **저장 위치** | `arena_membership_requests`(신규) 또는 기존 `memberships` 확장. 직군·입사일·리더시작일은 Arena tenure 계산에만 사용하므로 Arena 전용 테이블이면 충분. |
| **상태** | `pending` → Admin 승인 → `approved`. `approved_at`, `approved_by`(admin user_id 또는 이메일) 저장. |
| **이메일** | 가입/수정 시 Resend, SendGrid, 또는 Supabase Edge Function으로 ddshanbit@gmail.com에 “승인 대기: {유저 이메일}, 직군, 입사일, 리더시작일” + Dashboard 링크 전송. |
| **Admin 승인 UI** | 기존 Admin 영역에 “Arena 멤버십 승인” 목록(pending만) + [승인] 버튼. 승인 시 `status=approved`, `joined_at`/`leader_started_at` 확정(또는 요청값으로 업데이트). |
| **접근** | `unlocked-scenarios` 등에서 `status=approved`인 멤버십만 tenure(joined_at, leader_started_at) 사용. pending이면 “승인 대기 중” 메시지 + 레벨 비노출. |

### 1.3 “아랫단계 모두 오픈” 규칙

- **규칙**: `maxUnlockedLevel`이 L1 이상이면 **S1, S2, S3도 모두 오픈**.
- **구현**: `getUnlockedContentWindow` 또는 시나리오 목록을 돌리는 쪽에서 “leader 트랙이고 maxUnlockedLevel >= L1이면 staff 레벨 S1~S3도 포함”으로 필터.
- **표현**: “리더 트랙이어도 기초(S1–S3) 시나리오를 모두 플레이할 수 있습니다” 문구 + 대시보드/레벨 카드에서 S1–S3를 “기초 연습”으로 표시.

---

## 2. ARENA LEVELS 카드 (대시보드)

- **현재**: 문서(ARENA_L4_VERIFICATION 등)에만 있고 **대시보드에 카드 없음**.
- **제안**: 대시보드에 **“ARENA LEVELS”** ProgressCard 추가.
  - `GET /api/arena/unlocked-scenarios` 호출.
  - 표시 내용: **Track**(staff/leader), **Unlocked up to**(예: S2, L1), **레벨별 라벨 + 시나리오 개수** (예: S1: 20개, S2: 15개).
  - L4는 `l4_access` 있을 때만 “L4 (Partner) — admin-granted” 문구와 함께 표시 (기존 스펙 유지).
- **승인 대기 시**: “멤버십 승인 대기 중입니다. 승인 후 레벨이 표시됩니다.” 메시지.

---

## 3. 레벨 표현 아이디어 (게임적 요소)

목표: **레벨을 “S1/L1” 텍스트만이 아니라 시각적으로 재미있게** 표현.

### 3.1 옵션 A: 지도 여정 (Map Journey)

- **개념**: 가로 또는 세로 **지도/길** 위에 S1 → S2 → S3 / L1 → L2 → L3 구간을 표시.
- **현재 위치**: `maxUnlockedLevel`에 해당하는 **마커가 깜빡이거나 하이라이트**.
- **미개척 구간**: 흐리게 또는 자물쇠 아이콘.
- **장점**: “여정”, “성장” 느낌이 강함. 모바일에서도 스와이프로 구간 탐색 가능.

### 3.2 옵션 B: 탑 / 계단 (Tower / Stairs)

- **개념**: 세로 **탑** 또는 **계단**. 아래가 S1/L1, 위가 S3/L3(또는 L4).
- **현재 위치**: 사용자 **아이콘이 해당 층에서 깜빡임**.
- **오픈된 층**: 밝게; **잠긴 층**: 어둡게 + 자물쇠.
- **장점**: “올라간다”는 메타포가 명확. 리더보드와도 잘 어울림(탑 정상이 최고 레벨).

### 3.3 옵션 C: 프로그레스 바 + 단계 (Bar + Steps)

- **개념**: 가로 **진행 바** 위에 S1, S2, S3(또는 L1~L4)를 **단계 점**으로 표시.
- **현재 위치**: 해당 **단계 점이 강조(깜빡임/색상)**.
- **장점**: 구현 단순, 정보 밀도 높음. 대시보드 카드 안에 넣기 좋음.

### 3.4 옵션 D: S1/L1 라벨 + 미니 애니메이션

- **개념**: 텍스트는 **S1, S2, L1** 등 유지하되, **카드/버튼에 호버 시 짧은 애니메이션**(예: 빛나는 테두리, 아이콘 펄스).
- **현재 레벨**: 카드만 **살짝 크게 + 깜빡이는 테두리**.
- **장점**: 기존 “S1” 식 표현을 유지하면서 게임 느낌만 추가.

### 3.5 추천 조합

- **Phase 1**: **옵션 C (Bar + Steps)** 로 대시보드 “ARENA LEVELS” 카드에 **레벨 단계 + 현재 위치 깜빡임** 적용. 빠르게 구현 가능.
- **Phase 2**: 별도 **“My Arena Journey”** 페이지에서 **옵션 A (지도 여정)** 또는 **옵션 B (탑)** 로 확장. 지도/탑 에셋은 나중에 디자인과 맞춰 추가.

---

## 4. 아바타 아이디어

### 4.1 “3D 존재 여러 개 + 그중 선택”

- **개념**: 아바타를 **미리 만든 3D 캐릭터 N종** 중에서 사용자가 **한 명 선택**.
- **저장**: 선택한 캐릭터 **id**(예: `avatar_character_id: "wizard_02"`)를 프로필에 저장. 실제 렌더는 해당 id에 맞는 2D 썸네일/이미지 URL 또는 추후 3D 뷰어.
- **구현 난이도**: 3D 런타임(Three.js 등)은 부담이 크므로, **1차는 2D 일러스트 N종**으로 “캐릭터 선택” UI를 만들고, 선택값만 저장해 두는 방식 권장. 3D는 추후 교체 가능.

### 4.2 “레벨이 올라갈수록 옷 바뀜”

- **개념**: **같은 캐릭터**라도 **Tier/Stage 또는 Arena 레벨**에 따라 **의상/스킨**이 바뀜.
  - 예: S1 → 기본복, S2 → 조금 업그레이드, L1 → 리더 느낌 옷, L4 → 파트너급 코스튬.
- **저장**: `avatar_character_id` + **현재 적용 스킨**은 서버에서 `tier`/`maxUnlockedLevel`로 계산해서 프론트에 내려주거나, 프론트에서 tier/level 기반으로 스프라이트/이미지 키 선택.
- **장점**: 성장 보상 느낌, 리더보드/대시보드에서 “레벨이 보인다”는 만족도 상승.

### 4.3 현재 아바타와의 관계

- **지금**: URL 입력/업로드로 `avatar_url` 1개 저장 → 리더보드/대시보드에 표시.
- **추가**:  
  - **캐릭터 선택**: `avatar_character_id`(선택지 id)를 프로필에 추가.  
  - **옷/스킨**: `avatar_url`을 “캐릭터+레벨”별로 매핑한 **기본 세트**로 두고, 사용자가 URL을 덮어쓰지 않으면 **레벨에 따라 자동으로 기본 옷 이미지** 사용.  
  - 사용자 업로드/URL이 있으면 기존처럼 그대로 사용(커스텀 우선).

### 4.4 옷의 두 방향 — 직업군 vs 롤플레잉 (제안 의견)

| 방향 | 설명 | 장점 |
|------|------|------|
| **직업군 (Professional)** | 의사 가운, 스크럽(어시스턴트), 양복·정장 등 **치과/현장에 맞는 옷** | 현장 동질감, 리더십·역할 메타포가 직관적. |
| **롤플레잉 (Fantasy)** | 마법사, 전사, 상인 등 **RPG/판타지 직업** | 게임 몰입감, 재미·개성. Arena가 "여정/성장 게임"으로 느껴짐. |

**제안**: **둘 다 지원**하고, 사용자가 **테마를 선택**하게 함. 설정에 `avatar_outfit_theme` (`professional` \| `fantasy`) 추가. 레벨 업 시 선택한 테마 안에서만 옷이 바뀜. 캐릭터 베이스는 **게임 느낌 일러스트**로 통일.

### 4.5 캐릭터·옷 에셋 — 우리 제작 vs AI 도움

| 방식 | 장점 | 단점 |
|------|------|------|
| **팀/디자이너 직접 제작** | 브랜드·치과 맥락 일관성, 저작권 명확, 직업군(가운·스크럽) 정확 | 시간·비용, 인력 필요 |
| **AI 이미지 생성** (DALL·E, Midjourney, Ideogram 등) | 빠른 프로토타입, 변형 많음, 비용 상대적 적음 | 스타일·캐릭터 일관성 유지 어렵고, 치과/의료 맥락 오류 가능, 이용약관·상업 이용 확인 필요 |
| **하이브리드** | 키 캐릭터/포즈만 팀이 정하거나 AI 초안 후 선별 → 옷/레벨별 변형만 AI 또는 팀이 추가 | 역할 나누기와 워크플로 정리가 필요 |

**추천**:  
- **1차(MVP)**: 실제 이미지 없이 **placeholder(이니셜·아이콘)** 또는 **무료/저작권 확정 아이콘**으로 캐릭터 id·옷 id만 연동해 두고, “캐릭터 선택 + 테마 + 레벨→옷” **플로우만** 완성.  
- **에셋 제작 단계**:  
  - **일관성·브랜드가 중요하면** → 팀(또는 용역 디자이너)이 캐릭터 1~2종 + 테마별 옷 세트 제작.  
  - **빠른 시안·아이디어가 중요하면** → AI로 초안 생성 후 팀이 선별·수정하거나, “AI 생성 + 프롬프트 고정”으로 한 캐릭터의 옷만 변형해 사용.  

즉, **캐릭터/옷 디자인은 “우리가 한다” vs “다른 AI 도움”을 팀이 선택**하면 되고, 코드/데이터 구조는 **id + URL**만 갖춰 두면 두 방식 다 나중에 에셋만 넣어서 적용 가능하다.

---

## 5. 구현 순서 제안

| 순서 | 항목 | 설명 |
|------|------|------|
| 1 | **arena_membership_requests (또는 확장)** | 직군·입사일·리더시작일·status(pending/approved)·approved_at·approved_by. 마이그레이션 + API. |
| 2 | **가입/수정 폼 + 이메일** | 가입 시 입력 UI → 저장(pending) → ddshanbit@gmail.com으로 이메일. |
| 3 | **Admin 승인 UI** | pending 목록 + [승인] → status=approved, tenure 필드 반영. |
| 4 | **unlocked-scenarios 연동** | approved 멤버십만 tenure 사용; “아랫단계 오픈”(L1이면 S1–S3 포함) 반영. |
| 5 | **대시보드 ARENA LEVELS 카드** | unlocked-scenarios 호출 → Track, Unlocked up to, 레벨별 시나리오 수 표시. (옵션 C Bar+Steps 적용 가능.) |
| 6 | **레벨 시각화** | Bar+Steps 또는 탑/지도 중 1종 선택해 “현재 위치 깜빡임” 적용. |
| 7 | **아바타 캐릭터 선택** | 2D 캐릭터 N종 → 선택 UI → `avatar_character_id` 저장. |
| 8 | **아바타 레벨별 옷** | tier/level → 스킨 매핑 테이블 또는 설정 파일 → 기본 아바타 이미지 URL 결정. |

---

## 6. 정리

- **멤버십**: 가입 시 직군·입사일·리더시작일 입력 → **이메일(ddshanbit@gmail.com)** → **Admin 승인** → 해당 리(트랙) 접근. **L1이면 S1–S3도 오픈**.
- **ARENA LEVELS 카드**: 대시보드에 추가하고, `unlocked-scenarios` 기반으로 Track / Unlocked up to / 레벨별 시나리오 수 표시.
- **레벨 표현**: 1차는 **Bar+Steps + 현재 위치 깜빡임**, 이후 **지도 여정** 또는 **탑**으로 확장.
- **아바타**: **여러 3D(또는 2D) 캐릭터 중 선택** + **레벨 업 시 옷 변경**으로 게임적 보상 강화.

이 순서대로 진행할지, 특정 항목만 먼저 할지 정해 주시면 그에 맞춰 단계별 구현안을 더 쪼개 드리겠습니다.
